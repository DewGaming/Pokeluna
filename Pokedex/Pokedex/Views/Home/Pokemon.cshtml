@using Pokedex.Models;
@using Pokedex.DataAccess.Models;
@using System.Collections.Generic;
@using MoreLinq;
@model Pokedex.Models.AdminPokemonDropdownViewModel;
@{
    string style = string.Empty;
    ViewBag.Title = @Model.PokemonList.FirstOrDefault().Pokemon.Name;
    ViewBag.Description = string.Concat("View the information for the ", @Model.PokemonList.FirstOrDefault().Pokemon.Classification.Name, ", ", @Model.PokemonList.FirstOrDefault().Pokemon.Name, "!");
    ViewBag.Image = @Url.Content(string.Concat(@Model.PokemonList.FirstOrDefault().AppConfig.WebUrl, @Model.PokemonList.FirstOrDefault().AppConfig.GridImageUrl, @Model.PokemonList.FirstOrDefault().Pokemon.Id, ".png"));
    AdminPokemonViewModel adminPokemon = null;
    if (this.User.IsInRole("Owner"))
    {
        adminPokemon = new AdminPokemonViewModel() { DropdownViewModel = Model.AdminDropdown.DropdownViewModel };
    }
    int[] generations = null;
}

@section styles
{
    <link href="~/css/pageLookup.css" rel="stylesheet" asp-append-version="true" />
    <link href="~/css/typeChart.css" rel="stylesheet" asp-append-version="true" />
    <link href="~/css/pokemonPage.css" rel="stylesheet" asp-append-version="true" />
    <link href="~/css/select2.css" rel="stylesheet" asp-append-version="true" />
    <link class="tabIcon" rel="icon" type="image/png" href="@Url.Content(string.Concat(@Model.PokemonList.FirstOrDefault().AppConfig.WebUrl, @Model.PokemonList.FirstOrDefault().AppConfig.IconImageUrl, @Model.PokemonId, ".png"))" />

    <style>
        .mb-4 {
            margin-bottom: 0 !important;
        }
    </style>
    @if (this.User.IsInRole("Owner"))
    {
        <style>
            .btn-group {
                margin: 10px 0 10px;
            }
        </style>
    }
}

@section scripts
{
    <script src="~/js/pokemonPage.js" asp-append-version="true"></script>
    <script src="~/js/pageLookup.js" asp-append-version="true"></script>
}

<meta name="robots" content="noindex, nofollow" />
@Html.HiddenFor(x => x.LatestGenerationId)
@Html.HiddenFor(x => x.PokemonList.First().Pokemon.Name)

<table class="surroundingPokemon pokemonPicture">
    <tr>
        <td class="previousPokemon">
            <table>
                <tr>
                    <td>
                        <a href="@this.Url.Action("Pokemon", "Home", new { name = Model.PokemonList.First().SurroundingPokemon[0].Name.Replace(": ", "_").Replace(' ', '_').ToLower() })">← </a>
                    </td>
                    <td>
                        <a href="@this.Url.Action("Pokemon", "Home", new { name = Model.PokemonList.First().SurroundingPokemon[0].Name.Replace(": ", "_").Replace(' ', '_').ToLower() })">
                            <img class="lightshadowed" title="@Model.PokemonList.First().SurroundingPokemon[0].Name" loading="lazy" src="@Url.Content(string.Concat(@Model.PokemonList.First().AppConfig.WebUrl, @Model.PokemonList.First().AppConfig.IconImageUrl, @Model.PokemonList.First().SurroundingPokemon[0].Id, ".png"))" />
                        </a>
                    </td>
                </tr>
            </table>
        </td>
        <td class="nextPokemon">
            <table>
                <tr>
                    <td>
                        <a href="@this.Url.Action("Pokemon", "Home", new { name = Model.PokemonList.First().SurroundingPokemon[1].Name.Replace(": ", "_").Replace(' ', '_').ToLower() })">
                            <img class="lightshadowed" title="@Model.PokemonList.First().SurroundingPokemon[1].Name" loading="lazy" src="@Url.Content(string.Concat(@Model.PokemonList.First().AppConfig.WebUrl, @Model.PokemonList.First().AppConfig.IconImageUrl, @Model.PokemonList.First().SurroundingPokemon[1].Id, ".png"))" />
                        </a>
                    </td>
                    <td>
                        <a href="@this.Url.Action("Pokemon", "Home", new { name = Model.PokemonList.First().SurroundingPokemon[1].Name.Replace(": ", "_").Replace(' ', '_').ToLower() })"> →</a>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>

@{
    List<Evolution> preEvolutions = new List<Evolution>();
    List<Evolution> evolutions = new List<Evolution>();
    string pokemonName = Model.PokemonList.First().Pokemon.Name;
}
@foreach (var item in Model.PokemonList)
{
    string iconLink = Url.Content(string.Concat(item.AppConfig.WebUrl, item.AppConfig.IconImageUrl, item.Pokemon.Id, ".png"));
    generations = item.GamesAvailableIn.Select(x => x.GenerationId).Distinct().ToArray();
    @if (this.User.IsInRole("Owner"))
    {
        adminPokemon.Pokemon = item.Pokemon;
    }
    
    <div class="generations@(@item.Pokemon.Id == @Model.PokemonId ? " active" : string.Empty)" id="@item.Pokemon.Name.Replace("!", "Exclamation").Replace("?", "Question").Replace("%", string.Empty).Replace(".",string.Empty).Replace("'", string.Empty).Replace("(", string.Empty).Replace(")", string.Empty).Replace(" ", string.Empty)">    
        @if (!item.Pokemon.IsComplete)
        {
            <hr class="incompletePokemonHeader">
            <h4>Please be aware that the information for this Pokémon is not complete due to not all the information being available. Some information may change as more is revealed.</h4>
        }

        @foreach(var g in item.GamesAvailableIn.Select(x => x.GenerationId).Distinct())
        {
            string gameColors = string.Concat(@item.GamesAvailableIn.Where(x => x.GenerationId == g).ToList()[0].GameColor, " 50%, ");
            if (@item.GamesAvailableIn.Where(x => x.GenerationId == g).Count() > 1)
            {
                gameColors = string.Concat(gameColors, @item.GamesAvailableIn.Where(x => x.GenerationId == g).ToList()[1].GameColor, " 50%)");
            }
            else
            {
                gameColors = string.Concat(gameColors, @item.GamesAvailableIn.Where(x => x.GenerationId == g).ToList()[0].GameColor, " 50%)");
            }

            <button style="@(item.GamesAvailableIn.First(x => x.GenerationId == g).GameColor != string.Empty ? string.Concat("background: linear-gradient(135deg, ", gameColors) : string.Empty)"class="@(@g == @Model.GenerationId ? "active" : string.Empty)" onclick="lookupPokemon('@item.Pokemon.Name.Replace("!", "Exclamation").Replace("?", "Question").Replace("%", string.Empty).Replace("'", string.Empty).Replace(".", string.Empty).Replace("(", string.Empty).Replace(")", string.Empty).Replace(" ", string.Empty)', '@iconLink', '@item.Pokemon.Name.Replace("'", "&apos;")', '@g')" id="Generation@(g)">Generation @(g)</button>
        }
    </div>

    @foreach(var g in generations)
    {
        preEvolutions = new List<Evolution>();
        evolutions = new List<Evolution>();
        if (item.PreEvolutions.OrderByDescending(x => x.GenerationId).Where(x => x.GenerationId <= g).Count() > 0)
        {
            foreach (var e in item.PreEvolutions.OrderByDescending(x => x.GenerationId).DistinctBy(x => x.PreevolutionPokemonId))
            {
                if (item.PreEvolutions.OrderByDescending(x => x.GenerationId).Where(x => x.GenerationId <= g && x.PreevolutionPokemonId == e.PreevolutionPokemonId).Count() > 0)
                {
                    preEvolutions.Add(item.PreEvolutions.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g && x.PreevolutionPokemonId == e.PreevolutionPokemonId));
                }
            }
        }

        if (item.Evolutions.OrderByDescending(x => x.GenerationId).Where(x => x.GenerationId <= g).Count() > 0)
        {
            foreach (var e in item.Evolutions.OrderByDescending(x => x.GenerationId).DistinctBy(x => x.EvolutionPokemonId))
            {
                if (item.Evolutions.OrderByDescending(x => x.GenerationId).Where(x => x.GenerationId <= g && x.EvolutionPokemonId == e.EvolutionPokemonId).Count() > 0)
                {
                    evolutions.Add(item.Evolutions.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g && x.EvolutionPokemonId == e.EvolutionPokemonId));
                }
            }
        }

        if (this.User.IsInRole("Owner"))
        {
            adminPokemon.GenerationId = g;
        }

        <div class="page generation@(g) pokemon@(@item.Pokemon.Id == @Model.PokemonId && @g == @Model.GenerationId ? " active" : string.Empty)" id="@item.Pokemon.Name.Replace("!", "Exclamation").Replace("?", "Question").Replace("%", string.Empty).Replace(".",string.Empty).Replace("'", string.Empty).Replace("(", string.Empty).Replace(")", string.Empty).Replace(" ", string.Empty)">
            <div class="pokemonInfo pokemonPicture pokemonTables">
                <div style="@(Model.PokemonList.Count() > 1 ? "display: flex" : string.Empty)">
                    @if (Model.PokemonList.Count() > 1 && item.Pokemon.Id != 1882)
                    {
                        <div class="differentForms">
                            <h2 class="formHeader">Forms</h2>
                            <div class="formButtons">
                            @foreach (var button in Model.PokemonList.Where(x => x.Pokemon.Id != item.Pokemon.Id && x.Pokemon.Id != 1882))
                            {
                                iconLink = Url.Content(string.Concat(button.AppConfig.WebUrl, button.AppConfig.IconImageUrl, button.Pokemon.Id, ".png"));
                                <div class="@button.Pokemon.Name">
                                    <button onclick="lookupPokemon('@button.Pokemon.Name.Replace("!", "Exclamation").Replace("?", "Question").Replace("%", string.Empty).Replace("'", string.Empty).Replace(".", string.Empty).Replace("(", string.Empty).Replace(")", string.Empty).Replace(" ", string.Empty)', '@iconLink', '@button.Pokemon.Name.Replace("'", "&apos;")', '@g')">
                                        <img class="lightshadowed" title="@button.Pokemon.Name" id="@button.Pokemon.Id" loading="lazy" src="@Url.Content(string.Concat(@button.AppConfig.WebUrl, @button.AppConfig.IconImageUrl, @button.Pokemon.Id, ".png"))" />
                                    </button>
                                </div>
                            }
                            </div>
                        </div>
                    }
                    <div class="shadowed@(Model.PokemonList.Count() > 1 ? " pokemonWithForms" : string.Empty)">
                        <div class="pokemonImage">
                            <div class="official current" style="@(!item.HasShiny && !item.HasHome ? "position: relative !important" : "")">
                                <img title="@item.Pokemon.Name" id="@item.Pokemon.Id" loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.OfficialPokemonImageUrl, @item.Pokemon.Id, ".png"))" />
                            </div>
                            @if (@item.HasFemaleGenderDifference || @item.HasMaleGenderDifference)
                            {
                                <div class="genderDifference genderDifferenceOfficial">
                                    @if (@item.HasFemaleGenderDifference)
                                    {
                                        <img loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GenderDifferencePokemonImageUrl, @item.Pokemon.Id, "-f.png"))" />
                                    }
                                    else if (@item.HasMaleGenderDifference)
                                    {
                                        <img loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GenderDifferencePokemonImageUrl, @item.Pokemon.Id, "-m.png"))" />
                                    }
                                </div>
                                <div class="genderDifference genderDifferenceShiny">
                                    @if (@item.HasFemaleGenderDifference)
                                    {
                                        <img loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GenderDifferenceShinyPokemonImageUrl, @item.Pokemon.Id, "-f.png"))" />
                                    }
                                    else if (@item.HasMaleGenderDifference)
                                    {
                                        <img loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GenderDifferenceShinyPokemonImageUrl, @item.Pokemon.Id, "-m.png"))" />
                                    }
                                </div>
                                <div class="genderDifference genderDifferenceHome">
                                    @if (@item.HasFemaleGenderDifference)
                                    {
                                        <img loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GenderDifferenceHomePokemonImageUrl, @item.Pokemon.Id, "-f.png"))" />
                                    }
                                    else if (@item.HasMaleGenderDifference)
                                    {
                                        <img loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GenderDifferenceHomePokemonImageUrl, @item.Pokemon.Id, "-m.png"))" />
                                    }
                                </div>

                                <div class="genderSign default pokemonListPicture" onclick="differenceRender()">
                                    @if (@item.HasFemaleGenderDifference)
                                    {
                                        <img loading="lazy" title="default" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GeneralImageUrl, "male.png"))">
                                    }
                                    else if (@item.HasMaleGenderDifference)
                                    {
                                        <img loading="lazy" title="default" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GeneralImageUrl, "female.png"))">
                                    }
                                </div>
                                <div class="genderSign difference pokemonListPicture hidden" onclick="differenceRender()">
                                    @if (@item.HasFemaleGenderDifference)
                                    {
                                        <img loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GeneralImageUrl, "female.png"))">
                                    }
                                    else if (@item.HasMaleGenderDifference)
                                    {
                                        <img loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.GeneralImageUrl, "male.png"))">
                                    }
                                </div>
                            }
                            @if (@item.HasShiny)
                            {
                                <div class="shiny" style="@(!item.HasHome ? "position: relative !important" : "")">
                                    <img title="@item.Pokemon.Name" id="@item.Pokemon.Id" loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.ShinyPokemonImageUrl, @item.Pokemon.Id, ".png"))" />
                                </div>
                            }
                            @if (@item.HasHome)
                            {
                                <div class="home">
                                    <img title="@item.Pokemon.Name" id="@item.Pokemon.Id" loading="lazy" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.HomePokemonImageUrl, @item.Pokemon.Id, ".png"))" />
                                </div>
                            }
                        </div>
                        @if (Model.PokemonList.Count() > 1 && item.Pokemon.Id != 1882)
                        {
                            <div class="differentFormsMobile">
                                <h2>Different Forms</h2>
                                <div class="formButtonsMobile">
                                    @foreach (var button in Model.PokemonList.Where(x => x.Pokemon.Id != item.Pokemon.Id && x.Pokemon.Id != 1882))
                                    {
                                        iconLink = Url.Content(string.Concat(button.AppConfig.WebUrl, button.AppConfig.IconImageUrl, button.Pokemon.Id, ".png"));
                                        <button onclick="lookupPokemon('@button.Pokemon.Name.Replace("!", "Exclamation").Replace("?", "Question").Replace("%", string.Empty).Replace("'", string.Empty).Replace(".", string.Empty).Replace("(", string.Empty).Replace(")", string.Empty).Replace(" ", string.Empty)', '@iconLink', '@button.Pokemon.Name.Replace("'", "&apos;")', '@g')">
                                            <img class="lightshadowed" loading="lazy" title="@button.Pokemon.Name" src="@Url.Content(string.Concat(@button.AppConfig.WebUrl, @button.AppConfig.IconImageUrl, @button.Pokemon.Id, ".png"))" />
                                        </button>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                </div>
                @if (@item.HasShiny || @item.HasHome)
                {
                    <div class="pokemonImageButtons">
                        <button class="btn btn-primary officialButton hidden" onclick="officialRender()">View Official Artwork</button>
                        @if (@item.HasShiny)
                        {
                            <button class="btn btn-primary shinyButton" onclick="shinyRender()">View Shiny Artwork</button>
                        }
                        @if (@item.HasHome)
                        {
                            <button class="btn btn-primary homeButton" onclick="homeRender()">View Home Render</button>
                        }
                    </div>
                }
            </div>
            <div class="pokemonInfo pokemonData pokemonTables">
                @if (this.User.IsInRole("Owner"))
                {
                    @await Html.PartialAsync("_AdminPokemonDropdown", adminPokemon)
                }
                <h2>Pokémon Details</h2>
                <table class="pokedexNumber">
                    <tbody>
                        <tr>
                            <th>Pokémon Name</th>
                            <td>
                                @item.Pokemon.Name
                            </td>
                        </tr>
                        <tr>
                            <th>Pokedex Number</th>
                            <td>@('#')@item.Pokemon.PokedexNumber.ToString().PadLeft(4, '0')</td>
                        </tr>
                        <tr>
                            <th>Classification</th>
                            <td>@item.Pokemon.Classification.Name</td>
                        </tr>
                        @if (item.Pokemon.SpecialGroupingId != 1)
                        {
                            <tr>
                                <th>Special Grouping</th>
                                <td>@item.Pokemon.SpecialGrouping.Name</td>
                            </tr>
                        }
                        <tr>
                            <th>Height</th>
                            <td>
                                @{
                                    string height;

                                    if (item.Pokemon.Height != 0m)
                                    {
                                        var feet = 0;
                                        var inches = (int)Math.Round((@item.Pokemon.Height / 0.0254m), 0);
                                        while(inches >= 12)
                                        {
                                            feet++;
                                            inches -= 12;
                                        }

                                        height = string.Concat(feet, "'", inches.ToString("D2"), "\"", (item.Pokemon.IsAltForm && item.Pokemon.NameWithForm.Contains("Gigantamax")) ? "+" : string.Empty, " (", @item.Pokemon.Height.ToString("F1"), (item.Pokemon.IsAltForm && item.Pokemon.NameWithForm.Contains("Gigantamax")) ? "+" : string.Empty, " m)");
                                    }
                                    else
                                    {
                                        height = "???' ???\" (??? m)";
                                    }
                                }
                                @height
                            </td>
                        </tr>
                        <tr>
                            <th>Weight</th>
                            <td>
                                @{
                                    string weight;

                                    if (item.Pokemon.Weight != 0m)
                                    {
                                        weight = string.Concat(Math.Round(@item.Pokemon.Weight * (decimal)2.2046226, 1).ToString("0.####"), " lbs (", item.Pokemon.Weight.ToString("0.####"), " kg)");
                                    }
                                    else
                                    {
                                        weight = "??? lbs (??? kg)";
                                    }
                                }
                                @weight
                            </td>
                        </tr>
                        @if (g > 2)
                        {
                            <tr class="abilities">
                                <th>
                                    @if (item.Abilities.Count() == 0 || item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryAbility == null && (item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).HiddenAbility == null || g < 5))
                                    {
                                        @("Ability")
                                    }
                                    else
                                    {
                                        @("Abilities")
                                    }
                                </th>
                                <td>
                                    @if (@item.Abilities.Count() > 0)
                                    {
                                        <span class="cursorHelp" title="Ability Name: @item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).PrimaryAbility.Name
Description: @item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).PrimaryAbility.Description">
                                            @item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).PrimaryAbility.Name
                                        </span>
                                        @if (@item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryAbility != null)
                                        {
                                            <br>
                                            <span class="cursorHelp" title="Ability Name: @item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryAbility.Name
Description: @item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryAbility.Description">
                                                @item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryAbility.Name
                                            </span>
                                        }
                                        @if (@item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).HiddenAbility != null && @g >= 5)
                                        {
                                            <br>
                                            <span class="cursorHelp" title="Ability Name: @item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).HiddenAbility.Name
Description: @item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).HiddenAbility.Description">
                                                @item.Abilities.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).HiddenAbility.Name (Hidden)
                                            </span>
                                        }
                                    }
                                    else
                                    {
                                        @("???")
                                    }
                                </td>
                            </tr>
                        }
                        <tr>
                            <th>
                                @if (item.Pokemon.Game.Name.IndexOf('/') > -1)
                                {
                                    @("Games of Origin");
                                }
                                else
                                {
                                    @("Game of Origin");
                                }
                            </th>
                            <td>
                                @if (item.Pokemon.GameId == 43)
                                {
                                    @("Pokémon GO");
                                }
                                else
                                {
                                    @String.Join(" / ", item.GamesAvailableIn.Where(x => x.ReleaseDate == item.Pokemon.Game.ReleaseDate).Select(x => x.Name))
                                }
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            @if ((@g != 1 && item.EggGroups.Count() > 0) || (@g > 2 && item.EVYields.Count() > 0) || item.CaptureRates.Count() > 0 || item.Pokemon.ExperienceGrowthId != 8 || item.BaseHappinesses.Count() > 0)
            {
                <div class="pokemonInfo pokemonTraining pokemonTables">
                    <h2 class="morePokemonDetails">More Pokémon Details</h2>
                    <table style="min-width: 245.2px;">
                        <tbody>
                            @if (@g > 2 && item.EVYields.Count() > 0)
                            {
                                <tr>
                                    <th>EV Yield</th>
                                    <td>
                                        @if (item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Health != 0)
                                        {
                                            @item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Health@(" Health");
                                            <br>
                                        }
                                        @if (item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Attack != 0)
                                        {
                                            @if (item.Pokemon.Name == "Watchog" && @g == 5)
                                            {
                                                @("1 Attack in BW")
                                                <br>
                                                @("2 Attack in B2W2")
                                            }
                                            else
                                            {
                                                @item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Attack@(" Attack");
                                            }
                                            <br>
                                        }
                                        @if (item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Defense != 0)
                                        {
                                            @item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Defense@(" Defense");
                                            <br>
                                        }
                                        @if (item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SpecialAttack != 0)
                                        {
                                            @item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SpecialAttack@(" Sp. Attack");
                                            <br>
                                        }
                                        @if (item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SpecialDefense != 0)
                                        {
                                            @item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SpecialDefense@(" Sp. Defense");
                                            <br>
                                        }
                                        @if (item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Speed != 0)
                                        {
                                            @item.EVYields.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Speed@(" Speed");
                                            <br>
                                        }
                                    </td>
                                </tr>
                            }
                            @if (item.CaptureRates.Count() > 0)
                            {
                                <tr>
                                    <th>Catch Rate</th>
                                    <td class="catchRate">@item.CaptureRates.Find(x => x.PokemonId == @item.Pokemon.Id && x.GenerationId <= g).CaptureRate.CatchRate</td>
                                </tr>
                            }
                            @if (item.Pokemon.ExperienceGrowthId != 8)
                            {
                                <tr>
                                    <th>Experience Growth</th>
                                    <td>
                                       <span class="cursorHelp" title='@item.Pokemon.ExperienceGrowth.ExpPointTotal.ToString("N0") XP to Level 100'>@item.Pokemon.ExperienceGrowth.Name</span>
                                    </td>
                                </tr>
                            }
                            @if (item.BaseHappinesses.Count() > 0)
                            {
                                <tr>
                                    <th>Base Happiness</th>
                                    <td>@item.BaseHappinesses.Find(x => x.PokemonId == @item.Pokemon.Id && x.GenerationId <= g).BaseHappiness.Happiness</td>
                                </tr>
                            }
                            @if (g != 1)
                            {
                                <tr>
                                    <th>Gender Ratio</th>
                                    <td>
                                        @if (item.Pokemon.GenderRatio.MaleRatio == 0 && item.Pokemon.GenderRatio.FemaleRatio == 0)
                                        {
                                            @("Gender Unknown");
                                        }
                                        else
                                        {
                                            if (item.Pokemon.GenderRatio.FemaleRatio == 0)
                                            {
                                                <span class="maleRatio">@item.Pokemon.GenderRatio.MaleRatio@("% Male")</span>;
                                            }
                                            else if (item.Pokemon.GenderRatio.MaleRatio == 0)
                                            {
                                                <span class="femaleRatio">@item.Pokemon.GenderRatio.FemaleRatio@("% Female")</span>;
                                            }
                                            else if (item.Pokemon.GenderRatioId == 12)
                                            {
                                                @("???");
                                            }
                                            else
                                            {
                                                <span class="maleRatio">@item.Pokemon.GenderRatio.MaleRatio@("% Male")</span>
                                                @("/")
                                                <span class="femaleRatio">@item.Pokemon.GenderRatio.FemaleRatio@("% Female")</span>;
                                            }
                                        }
                                    </td>
                                </tr>
                            }
                            @if (@g != 1 && item.EggGroups.Count() > 0)
                            {
                                <tr>
                                    @if (item.EggGroups.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryEggGroup != null)
                                    {
                                        <th>Egg Groups</th>
                                    }
                                    else
                                    {
                                        <th>Egg Group</th>
                                    }
                                    <td>
                                        @item.EggGroups.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).PrimaryEggGroup.Name
                                        @if (item.EggGroups.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryEggGroup != null)
                                        {
                                            <br>
                                            @item.EggGroups.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryEggGroup.Name
                                        }
                                    </td>
                                </tr>
                                <tr>
                                   <th>Egg Cycles</th>
                                   <td>
                                       <span class="cursorHelp" title='@((item.Pokemon.EggCycle.CycleCount * 257).ToString("N0")) - @((item.Pokemon.EggCycle.CycleCount * 257 + 256).ToString("N0")) Steps to Hatch'>@item.Pokemon.EggCycle.CycleCount Egg Cycles</span>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            <div class="pokemonInfo pokemonGames pokemonTables">
                <h2>Games Available In</h2>
                <table>
                    <tbody>
                        @{
                            var gamesAvailableInInGeneration = @item.GamesAvailableIn.Where(x => g == x.GenerationId).OrderBy(x => x.ReleaseDate).ThenBy(x => x.Id).ToList();
                            var gamesAvailableInReleaseDates = gamesAvailableInInGeneration.Select(x => x.ReleaseDate).Distinct().ToArray();
                        }
                        @for (var i = 0; i < gamesAvailableInReleaseDates.Count(); i+=2)
                        {
                            var gameList = gamesAvailableInInGeneration.Where(x => x.ReleaseDate == gamesAvailableInReleaseDates[i]).ToList();
                            var regionalDexes = @item.RegionalDexes.Where(x => gameList.Any(y => y.Id == x.GameId)).ToList();
                            var regionalDexEntries = @item.RegionalDexEntries.Where(x => regionalDexes.Any(y => y.Id == x.RegionalDexId));
                            <tr>
                                <td>
                                    @for (var j = 0; j < gameList.Count(); j++)
                                    {
                                        @if (j > 0)
                                        {
                                            @(" / ")
                                        }
                                        @gameList[j].Name
                                    }

                                    @if (regionalDexes.Count() > 0 && regionalDexEntries.Count() > 0)
                                    {
                                        <br>
                                        <span class="weak">Regional Dex Number</span>
                                        @foreach (var dex in regionalDexes)
                                        {
                                            @if (item.RegionalDexEntries.Where(x => x.RegionalDexId == dex.Id).Count() > 0)
                                            {
                                                <br>
                                                if (gameList.First().Id == 37)
                                                {
                                                    if (regionalDexes.First().Id == dex.Id)
                                                    {
                                                        <span class="weak">@(dex.Name): @('#')@item.RegionalDexEntries.Find(x => x.RegionalDexId == dex.Id && x.PokemonId == item.Pokemon.Id).RegionalPokedexNumber.ToString().PadLeft(4, '0')</span>
                                                        @if (regionalDexes.Count() > 1)
                                                        {
                                                            <br>
                                                            <span>Appears in:</span>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <span class="weak">@(dex.Name)</span>
                                                    }
                                                }
                                                else
                                                {
                                                    <span class="weak">@(dex.Name): @('#')@item.RegionalDexEntries.Find(x => x.RegionalDexId == dex.Id && x.PokemonId == item.Pokemon.Id).RegionalPokedexNumber.ToString().PadLeft(4, '0')</span>
                                                }
                                            }
                                        }
                                    }
                                </td>
                                @if (@gamesAvailableInReleaseDates.Last() != @gamesAvailableInReleaseDates[i])
                                {
                                    gameList = gamesAvailableInInGeneration.Where(x => x.ReleaseDate == gamesAvailableInReleaseDates[i+1]).ToList();
                                    regionalDexes = @item.RegionalDexes.Where(x => gameList.Any(y => y.Id == x.GameId)).ToList();
                                    regionalDexEntries = @item.RegionalDexEntries.Where(x => regionalDexes.Any(y => y.Id == x.RegionalDexId));
                                    <td>
                                        @for(var j = 0; j < gameList.Count(); j++)
                                        {
                                            @if (j > 0)
                                            {
                                                @(" / ")
                                            }
                                            @gameList[j].Name
                                        }
                                        @if (regionalDexes.Count() > 0 && regionalDexEntries.Count() > 0)
                                        {
                                            <br>
                                            <span class="weak">Regional Dex Number</span>
                                            @foreach (var dex in regionalDexes)
                                            {
                                                @if (item.RegionalDexEntries.Where(x => x.RegionalDexId == dex.Id).Count() > 0)
                                                {
                                                    <br>
                                                    if (gameList.First().Id == 37)
                                                    {
                                                        if (regionalDexes.First().Id == dex.Id)
                                                        {
                                                            <span class="weak">@(dex.Name): @('#')@item.RegionalDexEntries.Find(x => x.RegionalDexId == dex.Id && x.PokemonId == item.Pokemon.Id).RegionalPokedexNumber.ToString().PadLeft(4, '0')</span>
                                                            <br>
                                                            <span>Appears in:</span>
                                                        }
                                                        else
                                                        {
                                                            <span class="weak">@(dex.Name)</span>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <span class="weak">@(dex.Name): @('#')@item.RegionalDexEntries.Find(x => x.RegionalDexId == dex.Id && x.PokemonId == item.Pokemon.Id).RegionalPokedexNumber.ToString().PadLeft(4, '0')</span>
                                                    }
                                                }
                                            }
                                        }
                                    </td>
                                }
                                else if (i > 1)
                                {
                                    <td></td>
                                }
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            @if (item.Typings.Count() > 0)
            {
                <div class="pokemonInfo pokemonTypingTable pokemonTables">
                    <div class="typingChart">
                        <div class="typing">
                            @if(g == 9 || pokemonName == "Arceus" || pokemonName == "Silvally")
                            {
                                <h2>Base Typing</h2>
                            }
                            else
                            {
                                <h2>Typing</h2>
                            }
                            <table>
                                <tr>
                                    <td>
                                        <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @item.Typings.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).PrimaryType.Name.ToLower(), ".png"))">
                                        @if (@item.Typings.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryType != null)
                                        {
                                            <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @item.Typings.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SecondaryType.Name.ToLower(), ".png"))">
                                        }
                                    </td>
                                </tr>
                            </table>
                        </div>
                        @if(g == 9 || pokemonName == "Arceus" || pokemonName == "Silvally")
                        {
                            <div class="teraTypingList">
                                <label for="TeraTypes">
                                    @if (pokemonName == "Arceus")
                                    {
                                        if (g == 9)
                                        {
                                            <h2>Plate/Tera</h2>
                                        }
                                        else if (g == 7)
                                        {
                                            <h2>Plate/Z Crystal</h2>
                                        }
                                        else
                                        {
                                            <h2>Arceus Plate</h2>
                                        }
                                    }
                                    else if (pokemonName == "Silvally")
                                    {
                                        if (g == 9)
                                        {
                                            <h2>Memory/Tera</h2>
                                        }
                                        else
                                        {
                                            <h2>RKS Memory</h2>
                                        }
                                    }
                                    else if (pokemonName.Contains("Ogerpon") || pokemonName.Contains("Terapagos") && item.Pokemon.Id != 1769)
                                    {
                                        <h2>Terastallized</h2>
                                    }
                                    else if (!pokemonName.Contains("Terapagos"))
                                    {
                                        <h2>Tera Typing</h2>
                                    }
                                </label>
                                @if (pokemonName.Contains("Ogerpon"))
                                {
                                    <select class="form-control teraTypeSelectList ogerponTera" id="TeraTypes" name="TeraTypes">
                                        <option value="0">Not Terastallized</option>
                                        @if (item.Pokemon.Id == 1768)
                                        {
                                            <option value="1">Grass</option>
                                        }
                                        else if (item.Pokemon.Id == 1879)
                                        {
                                            <option value="3">Water</option>
                                        }
                                        else if (item.Pokemon.Id == 1880)
                                        {
                                            <option value="4">Fire</option>
                                        }
                                        else if (item.Pokemon.Id == 1881)
                                        {
                                            <option value="18">Rock</option>
                                        }
                                    </select>
                                }
                                else if (pokemonName.Contains("Terapagos"))
                                {
                                    if (item.Pokemon.Id != 1769)
                                    {
                                        <select class="form-control teraTypeSelectList terapagosTera" id="TeraTypes" name="TeraTypes">
                                            <option value="0">Not Terastallized</option>
                                            <option value="99">Stellar</option>
                                        </select>
                                    }
                                }
                                else
                                {
                                    if (g != 9)
                                    {
                                        @Html.DropDownList("TeraTypes", new SelectList(@Model.AllTypes.Where(x => x.GenerationId <= g && x.Id != 99).ToList(), "Id", "Name"), new { @class = "form-control teraTypeSelectList" })
                                    }
                                    else
                                    {
                                        @Html.DropDownList("TeraTypes", new SelectList(@Model.AllTypes.Where(x => x.GenerationId <= g).ToList(), "Id", "Name"), new { @class = "form-control teraTypeSelectList" })
                                    }
                                }
                            </div>
                        }
                    </div>
                    <div class="effectivenessChart tableWithHeaders noRowBorders">
                        @{
                            var typeChart = item.Effectiveness.OrderByDescending(x => x.Generation.Id).First(x => x.Generation.Id <= g).TypeChart;
                            List<string> StrongAgainst = new List<string>();
                            List<string> WeakAgainst = new List<string>();
                            List<string> ImmuneTo = new List<string>();
                            if (g == 1)
                            {
                                typeChart = typeChart.Where(x => x.GenerationId == 1).ToList();
                            }
                            else if (g >= 2 && g <= 5)
                            {
                                typeChart = typeChart.Where(x => x.GenerationId == 2).ToList();
                            }
                            else if (g >= 6)
                            {
                                typeChart = typeChart.Where(x => x.GenerationId == 6).ToList();
                            }

                            foreach(var t in typeChart)
                            {
                                if (t.Effective == 0)
                                {
                                    ImmuneTo.Add(t.Attack.Name);
                                }
                                else if (t.Effective == 0.5m && !ImmuneTo.Contains(t.Attack.Name))
                                {
                                    if (StrongAgainst.Contains(t.Attack.Name))
                                    {
                                        StrongAgainst = StrongAgainst.Select(x => x.Replace(t.Attack.Name, t.Attack.Name + " Quad")).ToList();
                                    }
                                    else if (WeakAgainst.Contains(t.Attack.Name))
                                    {
                                        WeakAgainst.Remove(t.Attack.Name);
                                    }
                                    else
                                    {
                                        StrongAgainst.Add(t.Attack.Name);
                                    }
                                }
                                else if (t.Effective == 2 && !ImmuneTo.Contains(t.Attack.Name))
                                {
                                    if (WeakAgainst.Contains(t.Attack.Name))
                                    {
                                        WeakAgainst = WeakAgainst.Select(x => x.Replace(t.Attack.Name, t.Attack.Name + " Quad")).ToList();
                                    }
                                    else if (StrongAgainst.Contains(t.Attack.Name))
                                    {
                                        StrongAgainst.Remove(t.Attack.Name);
                                    }
                                    else
                                    {
                                        WeakAgainst.Add(t.Attack.Name);
                                    }
                                }
                            }

                            StrongAgainst.Sort();
                            WeakAgainst.Sort();
                            ImmuneTo.Sort();

                            if (item.Pokemon.Id == 1882)
                            {
                                WeakAgainst.Add("Stellar");
                            }

                            List<string> SuperStrong = StrongAgainst.Where(x => x.Contains("Quad")).ToList();
                            foreach(var s in SuperStrong)
                            {
                                StrongAgainst.Remove(StrongAgainst.Find(x => x == s));
                            }

                            List<string> SuperWeak = WeakAgainst.Where(x => x.Contains("Quad")).ToList();
                            foreach(var s in SuperWeak)
                            {
                                WeakAgainst.Remove(WeakAgainst.Find(x => x == s));
                            }
                        }
                        @if (StrongAgainst.Count > 0 || SuperStrong.Count() > 0)
                        {
                            <div class="StrongAgainst">
                                <h2>Resistances</h2>
                                <table class="typing-table-strong typing-table">
                                    <tbody>
                                        @if (SuperStrong.Count() > 0)
                                        {
                                            <tr>
                                                <td>
                                                    <b>Quad Resist</b>
                                                </td>
                                            </tr>
                                            @for (var i = 0; i < SuperStrong.Count(); i += 2)
                                            {
                                                <tr>
                                                    <td>
                                                        <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @SuperStrong[i].ToLower().Substring(0, @SuperStrong[i].IndexOf(" Quad")).ToLower(), ".png"))">
                                                        @if (SuperStrong.ElementAtOrDefault(i+1) != null)
                                                        {
                                                        <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @SuperStrong[i+1].ToLower().Substring(0, @SuperStrong[i+1].IndexOf(" Quad")).ToLower(), ".png"))">
                                                        }
                                                    </td>
                                                </tr>
                                            }
                                            if (StrongAgainst.Count > 0)
                                            {
                                                <tr>
                                                    <td>
                                                        <b>Regular Resist</b>
                                                    </td>
                                                </tr>
                                            }
                                        }
                                        @for (var i = 0; i < StrongAgainst.Count(); i += 2)
                                        {
                                            <tr>
                                                <td>
                                                    <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @StrongAgainst[i].ToLower(), ".png"))">
                                                    @if (StrongAgainst.ElementAtOrDefault(i+1) != null)
                                                    {
                                                    <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @StrongAgainst[i+1].ToLower(), ".png"))">
                                                    }
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                            style = string.Empty;
                        }
                        else
                        {
                            style = "display: flex;";
                        }
                        <div style="@style" class="nonResistances">
                            @if (WeakAgainst.Count > 0 || SuperWeak.Count() > 0)
                            {
                                <div class="WeakAgainst">
                                    <h2>Weaknesses</h2>
                                    <table class="typing-table-weak typing-table">
                                        <tbody>
                                        @if (SuperWeak.Count() > 0)
                                        {
                                            <tr>
                                                <td>
                                                    <b>Quad Weak</b>
                                                </td>
                                            </tr>
                                            @for (var i = 0; i < SuperWeak.Count(); i += 2)
                                            {
                                                <tr>
                                                    <td>
                                                        <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @SuperWeak[i].ToLower().Substring(0, @SuperWeak[i].IndexOf(" Quad")).ToLower(), ".png"))">
                                                        @if (SuperWeak.ElementAtOrDefault(i+1) != null)
                                                        {
                                                            <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @SuperWeak[i+1].ToLower().Substring(0, @SuperWeak[i+1].IndexOf(" Quad")).ToLower(), ".png"))">
                                                        }
                                                    </td>
                                                </tr>
                                            }
                                            if (WeakAgainst.Count > 0)
                                            {
                                                <tr>
                                                    <td>
                                                        <b>Regular Weakness</b>
                                                    </td>
                                                </tr>
                                            }
                                        }
                                        @for (var i = 0; i < WeakAgainst.Count(); i += 2)
                                        {
                                            <tr>
                                                <td>
                                                    <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @WeakAgainst[i].ToLower(), ".png"))">
                                                    @if (WeakAgainst.ElementAtOrDefault(i+1) != null)
                                                    {
                                                    <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @WeakAgainst[i+1].ToLower(), ".png"))">
                                                    }
                                                </td>
                                            </tr>
                                        }
                                        </tbody>
                                    </table>
                                </div>
                            }
                            @if (ImmuneTo.Count > 0)
                            {
                                <div class="ImmuneTo">
                                    <h2>Immunities</h2>
                                    <table class="typing-table-immune typing-table">
                                        <tbody>
                                        @for (var i = 0; i < ImmuneTo.Count(); i += 2)
                                        {
                                            <tr>
                                                <td>
                                                    <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @ImmuneTo[i].ToLower(), ".png"))">
                                                    @if (ImmuneTo.ElementAtOrDefault(i+1) != null)
                                                    {
                                                    <img loading="lazy" class="pokemon-type type-icon" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.TypeImageUrl, @ImmuneTo[i+1].ToLower(), ".png"))">
                                                    }
                                                </td>
                                            </tr>
                                        }
                                        </tbody>
                                    </table>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            }
            @if (item.BaseStats.Count() > 0)
            {
                <div class="pokemonInfo pokemonStats pokemonTables">
                    <h2>Base Stats</h2>
                    <table class="baseStatTable">
                        <tbody>
                            <tr>
                                <th class="Health" scope="col">Health</th>
                                <td class="statData"><div class="health statBar" style="width: @(@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Health * 100 / 255m)%;"></div></td>
                                <td class="Health">@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Health</td>
                            </tr>
                            <tr>
                                <th class="Attack" scope="col">Attack</th>
                                <td class="statData"><div class="attack statBar" style="width: @(@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Attack * 100 / 255m)%;"></div></td>
                                <td class="Attack">@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Attack</td>
                            </tr>
                            <tr>
                                <th class="Defense" scope="col">Defense</th>
                                <td class="statData"><div class="defense statBar" style="width: @(@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Defense * 100 / 255m)%;"></div></td>
                                <td class="Defense">@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Defense</td>
                            </tr>
                            <tr>
                                <th class="SpecialAttack" scope="col">
                                    @if (@g == 1)
                                    {
                                        @("Special")
                                    }
                                    else
                                    {
                                        @("Sp. Attack")
                                    }
                                </th>
                                <td class="statData"><div class="specialAttack statBar" style="width: @(@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SpecialAttack * 100 / 255m)%;"></div></td>
                                <td class="SpecialAttack">@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SpecialAttack</td>
                            </tr>
                            @if (@g != 1)
                            {
                                <tr>
                                    <th class="SpecialDefense" scope="col">Sp. Defense</th>
                                    <td class="statData"><div class="specialDefense statBar" style="width: @(@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SpecialDefense * 100 / 255m)%;"></div></td>
                                    <td class="SpecialDefense">@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).SpecialDefense</td>
                                </tr>
                            }
                            <tr>
                                <th class="Speed" scope="col">Speed</th>
                                <td class="statData"><div class="speed statBar" style="width: @(@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Speed * 100 / 255m)%;"></div></td>
                                <td class="Speed">@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).Speed</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <th class="baseStatTotal" scope="col">Total</th>
                                <td colspan="2" class="baseStatTotal"><b>@item.BaseStats.OrderByDescending(x => x.GenerationId).First(x => x.GenerationId <= g).StatTotal</b></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            }
            @if (preEvolutions.Count() > 0)
            {
                <div class="pokemonInfo pokemonEvos pokemonTables">
                    <div class="evolutions">
                        <h2>
                            @if (preEvolutions.Count() > 1)
                            {
                                @("Pre-Evolutions");
                            }
                            else
                            {
                                @("Pre-Evolution");
                            }
                        </h2>
                        <table style="@(evolutions.Count() == 0 ? "width: 47rem" : string.Empty)" class="preEvolutionTable">
                            @{
                                List<Evolution> preEvolutionList = preEvolutions.Where(x => g >= x.PreevolutionPokemon.Game.GenerationId).OrderBy(x => x.PreevolutionPokemon.PokedexNumber).ThenBy(x => x.PreevolutionPokemon.Id).ToList();
                            }
                            <tbody class="evolutionPokemon">
                                @foreach (var preEvolution in preEvolutionList)
                                {
                                    <tr>
                                        <th>
                                            @if (@preEvolution.PreevolutionPokemon.Name.Contains(" ("))
                                            {
                                                <a class="evolutionImage" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = preEvolution.PreevolutionPokemon.Name.Substring(0, preEvolution.PreevolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = preEvolution.PreevolutionPokemonId, generationId = @g })">
                                                    <img class="lightshadowed" loading="lazy" title="@preEvolution.PreevolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, @preEvolution.PreevolutionPokemon.Id, ".png"))" />
                                                </a>
                                            }
                                            else
                                            {
                                                <a class="evolutionImage" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = preEvolution.PreevolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = preEvolution.PreevolutionPokemonId, generationId = @g })">
                                                    <img class="lightshadowed" loading="lazy" title="@preEvolution.PreevolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, @preEvolution.PreevolutionPokemon.Id, ".png"))" />
                                                </a>
                                            }
                                        </th>
                                        <td>
                                            @if (@preEvolution.PreevolutionPokemon.Name.Contains(" ("))
                                            {
                                                <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = preEvolution.PreevolutionPokemon.Name.Substring(0, preEvolution.PreevolutionPokemon.Name.IndexOf(" (")).Substring(0, preEvolution.PreevolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = preEvolution.PreevolutionPokemonId, generationId = @g })">@preEvolution.PreevolutionPokemon.Name - @preEvolution.EvolutionMethod.Name</a>
                                            }
                                            else
                                            {
                                                <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = preEvolution.PreevolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = preEvolution.PreevolutionPokemonId, generationId = @g })">@preEvolution.PreevolutionPokemon.Name - @preEvolution.EvolutionMethod.Name</a>
                                            }
                                            @if (preEvolution.EvolutionDetails != null)
                                            {
                                                <p>@preEvolution.EvolutionDetails</p>
                                            }
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            }
            @if (evolutions.Count() > 0)
            {
                <div class="pokemonInfo pokemonEvos pokemonTables evolutions">
                    <h2>
                        @if (evolutions.Count() > 1 || (item.Pokemon.PokedexNumber == 412 && item.Pokemon.Id != 610))
                        {
                            @("Evolutions");
                        }
                        else
                        {
                            @("Evolution");
                        }
                    </h2>
                    <table style="@((preEvolutions.Count() <= 0 || g < preEvolutions.First().PreevolutionPokemon.Game.GenerationId) ? "width: 47rem" : string.Empty)" class="evolutionTable">
                        @{
                            List<Evolution> evolutionList = evolutions.Where(x => g >= x.EvolutionPokemon.Game.GenerationId).OrderBy(x => x.EvolutionPokemon.PokedexNumber).ThenBy(x => x.EvolutionPokemon.Id).ToList();
                        }
                        @if (preEvolutions.Count() > 0 && g >= preEvolutions.First().PreevolutionPokemon.Game.GenerationId)
                        {
                            <tbody class="evolutionPokemon">
                                @foreach (var evolution in evolutionList)
                                {
                                    <tr>
                                        <th>
                                            @if (@evolution.EvolutionPokemon.Name.Contains(" ("))
                                            {
                                                <a class="evolutionImage"  href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolution.EvolutionPokemon.Name.Substring(0, evolution.EvolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolution.EvolutionPokemonId, generationId = @g })">
                                                    <img class="lightshadowed" loading="lazy" title="@evolution.EvolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, @evolution.EvolutionPokemon.Id, ".png"))" />
                                                </a>
                                            }
                                            else
                                            {
                                                <a class="evolutionImage"  href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolution.EvolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolution.EvolutionPokemonId, generationId = @g })">
                                                    <img class="lightshadowed" loading="lazy" title="@evolution.EvolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, @evolution.EvolutionPokemon.Id, ".png"))" />
                                                </a>
                                            }
                                        </th>
                                        <td>
                                            @if (@evolution.EvolutionPokemon.Name.Contains(" ("))
                                            {
                                                <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolution.EvolutionPokemon.Name.Substring(0, evolution.EvolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolution.EvolutionPokemonId, generationId = @g })">@evolution.EvolutionPokemon.Name - @evolution.EvolutionMethod.Name</a>
                                            }
                                            else
                                            {
                                                <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolution.EvolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolution.EvolutionPokemonId, generationId = @g })">@evolution.EvolutionPokemon.Name - @evolution.EvolutionMethod.Name</a>
                                            }
                                            @if (evolution.EvolutionDetails != null)
                                            {
                                                <p>@evolution.EvolutionDetails</p>
                                            }
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        }
                        else
                        {
                            <tbody class="evolutionPokemon935">
                                @for (var i = 0; i < evolutionList.Count(); i += 2)
                                {
                                    <tr>
                                        <th>
                                            @if (@evolutionList[i].EvolutionPokemon.Name.Contains(" ("))
                                            {
                                                <a class="evolutionImage"  href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolutionList[i].EvolutionPokemon.Name.Substring(0, evolutionList[i].EvolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolutionList[i].EvolutionPokemonId, generationId = @g })">
                                                    <img class="lightshadowed" loading="lazy" title="@evolutionList[i].EvolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, @evolutionList[i].EvolutionPokemon.Id, ".png"))" />
                                                </a>
                                            }
                                            else
                                            {
                                                <a class="evolutionImage"  href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolutionList[i].EvolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolutionList[i].EvolutionPokemonId, generationId = @g })">
                                                    <img class="lightshadowed" loading="lazy" title="@evolutionList[i].EvolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, @evolutionList[i].EvolutionPokemon.Id, ".png"))" />
                                                </a>
                                            }
                                        </th>
                                        <td>
                                            @if (@evolutionList[i].EvolutionPokemon.Name.Contains(" ("))
                                            {
                                                <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolutionList[i].EvolutionPokemon.Name.Substring(0, evolutionList[i].EvolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolutionList[i].EvolutionPokemonId, generationId = @g })">@evolutionList[i].EvolutionPokemon.Name - @evolutionList[i].EvolutionMethod.Name</a>
                                            }
                                            else
                                            {
                                                <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolutionList[i].EvolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolutionList[i].EvolutionPokemonId, generationId = @g })">@evolutionList[i].EvolutionPokemon.Name - @evolutionList[i].EvolutionMethod.Name</a>
                                            }
                                            @if (evolutionList[i].EvolutionDetails != null)
                                            {
                                                <p>@evolutionList[i].EvolutionDetails</p>
                                            }
                                        </td>
                                        @if (evolutionList.ElementAtOrDefault(i+1) != null)
                                        {
                                            <th>
                                                @if (@evolutionList[i+1].EvolutionPokemon.Name.Contains(" ("))
                                                {
                                                    <a class="evolutionImage"  href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolutionList[i+1].EvolutionPokemon.Name.Substring(0, evolutionList[i+1].EvolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolutionList[i+1].EvolutionPokemonId, generationId = @g })">
                                                        <img class="lightshadowed" loading="lazy" title="@evolutionList[i+1].EvolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, @evolutionList[i+1].EvolutionPokemon.Id, ".png"))" />
                                                    </a>
                                                }
                                                else
                                                {
                                                    <a class="evolutionImage"  href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolutionList[i+1].EvolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolutionList[i+1].EvolutionPokemonId, generationId = @g })">
                                                        <img class="lightshadowed" loading="lazy" title="@evolutionList[i+1].EvolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, @evolutionList[i+1].EvolutionPokemon.Id, ".png"))" />
                                                    </a>
                                                }
                                            </th>
                                            <td>
                                                @if (@evolutionList[i+1].EvolutionPokemon.Name.Contains(" ("))
                                                {
                                                    <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolutionList[i+1].EvolutionPokemon.Name.Substring(0, evolutionList[i+1].EvolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolutionList[i+1].EvolutionPokemonId, generationId = @g })">@evolutionList[i+1].EvolutionPokemon.Name - @evolutionList[i+1].EvolutionMethod.Name</a>
                                                }
                                                else
                                                {
                                                    <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = evolutionList[i+1].EvolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = evolutionList[i+1].EvolutionPokemonId, generationId = @g })">@evolutionList[i+1].EvolutionPokemon.Name - @evolutionList[i+1].EvolutionMethod.Name</a>
                                                }
                                                @if (evolutionList[i+1].EvolutionDetails != null)
                                                {
                                                    <p>@evolutionList[i+1].EvolutionDetails</p>
                                                }
                                            </td>
                                        }
                                    </tr>
                                }
                            </tbody>
                            <tbody class="evolutionPokemon934">
                                @foreach (var e in evolutionList)
                                {
                                    <tr>
                                        <th>
                                            @if (e.EvolutionPokemon.Name.Contains(" ("))
                                            {
                                                <a class="evolutionImage"  href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = e.EvolutionPokemon.Name.Substring(0, e.EvolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = e.EvolutionPokemonId, generationId = @g })">
                                                    <img class="lightshadowed" loading="lazy" title="@e.EvolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, e.EvolutionPokemon.Id, ".png"))" />
                                                </a>
                                            }
                                            else
                                            {
                                                <a class="evolutionImage"  href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = e.EvolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = e.EvolutionPokemonId, generationId = @g })">
                                                    <img class="lightshadowed" loading="lazy" title="@e.EvolutionPokemon.Name" src="@Url.Content(string.Concat(@item.AppConfig.WebUrl, @item.AppConfig.IconImageUrl, e.EvolutionPokemon.Id, ".png"))" />
                                                </a>
                                            }
                                        </th>
                                        <td>
                                            @if (e.EvolutionPokemon.Name.Contains(" ("))
                                            {
                                                <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = e.EvolutionPokemon.Name.Substring(0, e.EvolutionPokemon.Name.IndexOf(" (")).Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = e.EvolutionPokemonId, generationId = @g })">@e.EvolutionPokemon.Name</a>
                                            }
                                            else
                                            {
                                                <a class="evolutionLink" href="@this.Url.Action("PokemonWithId", "Home", new { pokemonName = e.EvolutionPokemon.Name.Replace(": ", "_").Replace(' ', '_').ToLower(), pokemonId = e.EvolutionPokemonId, generationId = @g })">@e.EvolutionPokemon.Name</a>
                                            }
                                            <p>@e.EvolutionMethod.Name@(e.EvolutionDetails != null ? string.Concat(" (", e.EvolutionDetails, ")") : string.Empty)</p>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        }
                    </table>
                </div>
            }
            else
            {
                <div class="pokemonInfo pokemonTables emptyDiv"></div>
            }

            @if (g == 1 || !(preEvolutions.Count() > 0 && g >= preEvolutions.First().PreevolutionPokemon.Game.GenerationId))
            {
                <div class="pokemonInfo pokemonTables emptyDiv"></div>
            }
        </div>
    }
}